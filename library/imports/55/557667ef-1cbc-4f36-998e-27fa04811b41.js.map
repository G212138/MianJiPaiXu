{"version":3,"sources":["assets\\game\\scripts\\UI\\Item\\DituDrag.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { ListenerManager } from \"../../../../frame/scripts/Manager/ListenerManager\";\r\nimport { EventType } from \"../../Data/EventType\";\r\nimport FillArea from \"./FillArea\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class DituDrag extends cc.Component {\r\n    @property(cc.Node)\r\n    private fillArea: cc.Node[] = [];\r\n    @property(cc.Integer)\r\n    private index: number = 0;\r\n\r\n    private initPos: cc.Vec3 = null;\r\n    private initParent: cc.Node = null;\r\n\r\n    onLoad() {\r\n        this.initPos = this.node.position;\r\n        this.initParent = this.node.parent;\r\n        this.node.getChildByName(\"mianji_1\").active = true;\r\n        this.node.getChildByName(\"mianji_2\").active = false;\r\n    }\r\n\r\n    private onDragStart(event) {\r\n        let pos = event.target.parent.convertToWorldSpaceAR(cc.v2(event.pos.x, event.pos.y));\r\n        this.node.getChildByName(\"mianji_1\").active = false;\r\n        this.node.getChildByName(\"mianji_2\").active = true;\r\n    }\r\n\r\n    private onDragMove(event) {\r\n        this.node.getChildByName(\"mianji_1\").active = false;\r\n        this.node.getChildByName(\"mianji_2\").active = true;\r\n        let pos = event.target.parent.convertToWorldSpaceAR(cc.v2(event.pos.x, event.pos.y));\r\n        ListenerManager.dispatch(EventType.ON_DRAG_DITU, pos);\r\n    }\r\n\r\n    private onDragEnd(event) {\r\n        let pos = event.target.parent.convertToWorldSpaceAR(cc.v2(event.pos.x, event.pos.y));\r\n        let isInRect: boolean = false;\r\n        this.fillArea.forEach(gezi => {\r\n            if (gezi.getComponent(FillArea).isPosInRect(cc.v2(pos.x, pos.y))) {\r\n                isInRect = true;\r\n                gezi.getComponent(FillArea).fill(this.node);\r\n            }\r\n        });\r\n        if (!isInRect) {\r\n            this.reset();\r\n        }\r\n        ListenerManager.dispatch(EventType.ON_DRAG_DITU_END);\r\n    }\r\n\r\n    public reset() {\r\n        this.node.parent = this.initParent;\r\n        this.node.position = this.initPos;\r\n        this.node.getChildByName(\"mianji_1\").active = true;\r\n        this.node.getChildByName(\"mianji_2\").active = false;\r\n    }\r\n}\r\n"]}